@model QuizApp.Models.QuizAttempt
@{
    ViewData["Title"] = "Hasil Quiz - VisionExam";
    var percentage = Model.MaxScore > 0 ? (double)Model.Score / Model.MaxScore * 100 : 0;
    var grade = percentage >= 80 ? "A" : percentage >= 70 ? "B" : percentage >= 60 ? "C" : percentage >= 50 ? "D" : "E";
    var gradeColor = percentage >= 80 ? "success" : percentage >= 70 ? "primary" : percentage >= 60 ? "warning" : percentage >= 50 ? "orange" : "danger";
}

<div class="result-container">
    <!-- Success Header -->
    <div class="result-header">
        <div class="success-animation">
            <div class="success-circle">
                <i class="fas fa-check"></i>
            </div>
        </div>
        <h1 class="result-title">Quiz Selesai!</h1>
        <p class="result-subtitle">@Model.Quiz?.Title</p>
    </div>

    <!-- Grade Display -->
    <div class="grade-section">
        <div class="grade-display grade-@gradeColor">
            <div class="grade-letter">@grade</div>
            <div class="grade-score">@Model.Score / @Model.MaxScore</div>
            <div class="grade-percentage">(@percentage.ToString("F1")%)</div>
        </div>
    </div>

    <!-- Statistics Grid -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">@Model.Quiz?.Questions.Count</div>
                <div class="stat-label">Jumlah Soal</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">@((Model.CompletedAt - Model.StartedAt)?.TotalMinutes.ToString("F1"))</div>
                <div class="stat-label">Waktu (menit)</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-bullseye"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">@Model.Score</div>
                <div class="stat-label">Skor Benar</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-chart-pie"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">@percentage.ToString("F0")%</div>
                <div class="stat-label">Akurasi</div>
            </div>
        </div>
    </div>

    <!-- Violations Section -->
    @if (Model.Violations.Count > 0)
    {
        <div class="violations-section">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-exclamation-triangle"></i>
                    Catatan Pelanggaran (@Model.Violations.Count)
                </h2>
            </div>
            
            <div class="violations-grid">
                @{
                    var lookLeft = Model.Violations.Count(v => v.Type == QuizApp.Models.ViolationType.LookLeft);
                    var lookRight = Model.Violations.Count(v => v.Type == QuizApp.Models.ViolationType.LookRight);
                    var noFace = Model.Violations.Count(v => v.Type == QuizApp.Models.ViolationType.NoFace);
                    var multiFace = Model.Violations.Count(v => v.Type == QuizApp.Models.ViolationType.MultipleFaces);
                }
                
                <div class="violation-card @(lookLeft > 0 ? "violation-active" : "")">
                    <div class="violation-icon">
                        <i class="fas fa-arrow-left"></i>
                    </div>
                    <div class="violation-content">
                        <div class="violation-title">Menoleh Kiri</div>
                        <div class="violation-count">@lookLeft kali</div>
                    </div>
                </div>
                
                <div class="violation-card @(lookRight > 0 ? "violation-active" : "")">
                    <div class="violation-icon">
                        <i class="fas fa-arrow-right"></i>
                    </div>
                    <div class="violation-content">
                        <div class="violation-title">Menoleh Kanan</div>
                        <div class="violation-count">@lookRight kali</div>
                    </div>
                </div>
                
                <div class="violation-card @(noFace > 0 ? "violation-active" : "")">
                    <div class="violation-icon">
                        <i class="fas fa-user-slash"></i>
                    </div>
                    <div class="violation-content">
                        <div class="violation-title">Wajah Tidak Terdeteksi</div>
                        <div class="violation-count">@noFace kali</div>
                    </div>
                </div>
                
                <div class="violation-card @(multiFace > 0 ? "violation-active" : "")">
                    <div class="violation-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="violation-content">
                        <div class="violation-title">Banyak Wajah</div>
                        <div class="violation-count">@multiFace kali</div>
                    </div>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="clean-section">
            <div class="clean-badge">
                <i class="fas fa-shield-check"></i>
                <span>Tidak Ada Pelanggaran</span>
            </div>
            <p>Selamat! Anda mengerjakan quiz dengan integritas yang baik.</p>
        </div>
    }

    <!-- Action Buttons -->
    <div class="action-buttons">
        <a href="/Quiz" class="btn btn-primary">
            <i class="fas fa-play"></i>
            Quiz Lainnya
        </a>
        <a href="/Quiz/History" class="btn btn-secondary">
            <i class="fas fa-history"></i>
            Riwayat Quiz
        </a>
    </div>
</div>

<link rel="stylesheet" href="~/css/result.css" />
<script src="~/js/result.js"></script>